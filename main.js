!function(){"use strict";class t{constructor(t){this.board=t,this.footer=t.querySelector(".footer"),this.add=t.querySelector(".add_card"),this.textArea=t.querySelector(".card_text"),this.board.ondragover=this.drop}showAddBlock(){this.footer.classList.add("fog"),this.add.classList.remove("fog"),this.add.addEventListener("click",(t=>{"add_cross"==t.target.className?this.closeBlock():this.addCard()}))}addCard(){let t=this.textArea.value;""!=t&&(this.createCard(this.getId(),t),this.saveCard(t),this.closeBlock(),this.textArea.value="")}createCard(t,e){const s=document.createElement("div"),a=document.createElement("div");a.innerHTML="&#10006;",s.id=t,s.draggable="true",s.classList.add("card"),a.classList.add("cross"),a.classList.add("fog"),s.innerText=e,s.append(a),this.board.append(s)}getId(){let t=JSON.parse(localStorage.getItem(this.board.classList[1]));return null==t?`1${this.board.classList[1]}`:String(Number(String(Object.keys(t).slice(-1)).replace(/[^0-9]/g,""))+1)+String(this.board.classList[1])}saveCard(t){const e=JSON.parse(localStorage.getItem(this.board.classList[1])),s=this.getId(),a={};if(a[s]=t,null==e)localStorage.setItem(this.board.classList[1],JSON.stringify(a));else{let e=JSON.parse(localStorage.getItem(this.board.classList[1]));e[s]=t,localStorage.setItem(this.board.classList[1],JSON.stringify(e))}}delCard(t){const e=t.id,s=JSON.parse(localStorage.getItem(this.board.classList[1]));delete s[e],localStorage.setItem(this.board.classList[1],JSON.stringify(s)),t.remove()}closeBlock(){this.textArea.value="",this.footer.classList.remove("fog"),this.add.classList.add("fog")}saveState(){localStorage.removeItem(this.board.classList[1]);for(let t of this.board.children)"card"==t.className&&this.saveCard(t.innerText.replace(/[^a-zа-яё0-9\s]/gi,""))}}const e=new class{constructor(){this.card=void 0,this.cardParent=void 0,this.columns=document.querySelector(".column"),this.cards=document.querySelectorAll(".card"),this.table={todo:new t(document.querySelector(".todo")),inprogress:new t(document.querySelector(".inprogress")),done:new t(document.querySelector(".done"))}}drag(){const t=document.querySelector(".table");let e="",s="",a="",r="";t.addEventListener("dragenter",(t=>{t.target.classList.contains("column")&&t.target.classList.add("drop")})),t.addEventListener("dragleave",(t=>{t.target.classList.contains("drop")&&t.target.classList.remove("drop")})),t.addEventListener("dragstart",(t=>{t.target.classList.contains("card")&&(t.dataTransfer.setData("text/plain",t.target.id),a=t.target.offsetHeight,r=t.target,setTimeout((()=>{r.classList.add("fog")}),0))})),t.addEventListener("dragover",(t=>{t.preventDefault(),e=t.target,e.classList.contains("card")&&(e.id!=s.id&&""!=s&&(s.style.marginTop="20px"),s=t.target,e.style.marginTop=`${a+10}px`)})),t.addEventListener("drop",(a=>{r.classList.remove("fog");const o=t.querySelector(`[id="${a.dataTransfer.getData("text/plain")}"]`);if(e!==o){if(e.classList.contains("card")){const t=e.getBoundingClientRect().y+e.getBoundingClientRect().height/2;if(a.clientY>t){if(null===e.nextElementSibling)return;e=e.nextElementSibling}e.parentElement.insertBefore(o,e)}if(a.target.classList.contains("column")){if(s&&e.classList[1]==s.parentElement.classList[1])return s.parentElement.insertBefore(o,s),o.style.marginTop="20px",s.style.marginTop="20px",this.saveState(),void this.cleanState();a.target.append(o)}this.saveState(),this.cleanState()}}))}listener(){this.drag(),document.addEventListener("click",(t=>{if("footer"==t.target.className&&this.table[t.target.parentElement.classList[1]].showAddBlock(),"cross"==t.target.className){const e=t.target.parentElement.parentElement.classList[1];this.table[e].delCard(t.target.parentElement)}})),document.addEventListener("mouseover",(t=>{if("card"==t.target.classList[0]){let e=t.target.querySelector(".cross");e.classList.remove("fog"),e=""}})),document.addEventListener("mouseout",(t=>{if("card"==t.target.classList[0]){let e=t.target.querySelector(".cross");setTimeout((()=>{e.classList.add("fog"),e=""}),1200)}}))}localStateRead(){if(0!=localStorage.length)for(let t in localStorage)null!=localStorage.getItem(t)&&this.restoreState(t,localStorage.getItem(t))}restoreState(t,e){const s=JSON.parse(e);for(let e in s)this.table[t].createCard(e,s[e])}cleanState(){const t=document.querySelectorAll(".card");for(let e of t)e.remove();this.localStateRead()}saveState(){for(let t of Object.keys(this.table))this.table[t].saveState()}};e.localStateRead(),e.listener()}();
//# sourceMappingURL=main.js.map